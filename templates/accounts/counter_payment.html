{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>On-site Payment - LabangOnline</title>
  <link rel="stylesheet" href="{% static 'css/app.css' %}" />
  <link rel="stylesheet" href="{% static 'css/dashboard.css' %}" />
  <style>
    html, body { overflow: hidden; height: 100%; margin: 0; padding: 0; }
    .dashboard-wrapper { height: 100vh; overflow: hidden; display: flex; }
    .main-content { flex: 1; overflow-y: auto; overflow-x: hidden; height: 100vh; display: flex; flex-direction: column; }
    .container { max-width: 1100px; margin: 0 auto; padding: 24px; padding-bottom: 60px; }

    .page-header { margin-bottom: 24px; }
    .page-header h1 { font-size: 28px; font-weight: 700; color: #e5e7eb; margin: 0; }
    .light .page-header h1 { color: #111827; }
    .page-subtitle { color: #9ca3af; font-size: 14px; margin-top: 6px; }
    .light .page-subtitle { color: #374151; }

    .panel {
      background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
      border: 1px solid rgba(16,185,129,0.2);
      border-radius: 14px; padding: 18px 20px; margin-bottom: 16px;
    }
    .light .panel {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border: 1px solid rgba(16,185,129,0.3);
    }
    .panel h2 { margin: 0 0 8px; font-size: 16px; color: #e5e7eb; }
    .light .panel h2 { color: #111827; }

    .details-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px;
    }
    .detail-item { color: #cbd5e1; font-size: 14px; }
    .light .detail-item { color: #475569; }
    .detail-label { display:block; font-size:12px; color:#9ca3af; margin-bottom:4px; text-transform:uppercase; }
    .light .detail-label { color:#64748b; }
    .amount { font-weight:700; color:#10b981; }

    .steps { margin-top: 8px; }
    .steps ol { margin: 0; padding-left: 18px; color:#cbd5e1; }
    .light .steps ol { color:#475569; }
    .steps li { margin: 8px 0; }

    .alert {
      background: linear-gradient(135deg, rgba(245,158,11,0.1) 0%, rgba(251,191,36,0.1) 100%);
      border: 1px solid rgba(245,158,11,0.35);
      color: #f59e0b; border-radius: 10px; padding: 12px 14px; margin: 16px 0;
      font-size: 14px;
    }

    .actions { display:flex; gap:10px; margin-top: 12px; }
    .btn-primary {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white; border: 0; border-radius: 10px; padding: 12px 18px;
      font-weight: 700; cursor: pointer; transition: transform .2s ease, box-shadow .2s ease;
      box-shadow: 0 4px 12px rgba(16,185,129,0.3);
    }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(16,185,129,0.4); }

    .btn-secondary {
      background: rgba(148,163,184,0.12); color:#cbd5e1; border: 1px solid rgba(148,163,184,0.3);
      border-radius: 10px; padding: 12px 18px; font-weight: 600; cursor:pointer;
    }
    .light .btn-secondary { background:white; color:#334155; border-color:#cbd5e1; }

    .print-card {
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      background: rgba(16,185,129,0.06); border:1px dashed rgba(16,185,129,0.4);
      border-radius: 10px; padding: 12px 14px; margin-top: 10px;
    }
    .print-title { color:#10b981; font-weight:700; }
    .print-sub { color:#9ca3af; font-size: 13px; }
    .light .print-sub { color:#64748b; }

    .request-id {
      font-family: monospace; font-weight: 700; color:#10b981; font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="dashboard-wrapper">
    <aside class="sidebar">
      <div class="logo">
        <img src="{% static 'logo.png' %}" alt="Labang Logo" />
        <span>LabangOnline</span>
      </div>
      <div class="notification-item">
        <div class="notification-icon-wrapper">
          <img src="{% static 'icons/notification.png' %}" alt="Notification" />
          <span class="notification-badge">5</span>
        </div>
        <span>Notification</span>
      </div>
      <ul class="menu">
        <li class="menu-item" onclick="window.location.href='{% url 'accounts:personal_info' %}'">
          <img src="{% static 'icons/user-info.png' %}" alt=""><span>Personal Info</span>
        </li>
        <li class="menu-item active">
          <img src="{% static 'icons/request-records.png' %}" alt=""><span>Document Request</span>
        </li>
        <li class="menu-item"><img src="{% static 'icons/resident-record.png' %}" alt=""><span>Resident Records</span></li>
        <li class="menu-item"><img src="{% static 'icons/incident-report.png' %}" alt=""><span>Report Records</span></li>
        <li class="menu-item"><img src="{% static 'icons/file-report.png' %}" alt=""><span>File Report</span></li>
      </ul>
    </aside>

    <main class="main-content">
      <header class="topbar">
        <span></span>
        <button id="mode-toggle" class="btn">Toggle</button>
        <div class="user-profile">
          {% if profile_pic_base64 %}
            <img src="data:image/jpeg;base64,{{ profile_pic_base64 }}" alt="User Profile" />
          {% else %}
            <img src="{% static 'icons/default_user.png' %}" alt="User Profile" />
          {% endif %}
          <span>{{ request.user.full_name }}</span>
          <form method="get" action="{% url 'accounts:logout_confirm' %}">
            <button type="submit" class="btn-logout">LOGOUT</button>
          </form>
        </div>
      </header>

      <div class="container">
        <div class="page-header">
          <h1>On-site Payment</h1>
          <div class="page-subtitle">Pay at the Barangay Hall cashier. Bring your Request ID.</div>
        </div>

        <div class="panel">
          <h2>Request Summary</h2>
          <div class="details-grid">
            <div class="detail-item">
              <span class="detail-label">Request ID</span>
              <span class="request-id">{{ cert_request.request_id }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Certificate Type</span>
              <span>{{ cert_request.get_certificate_type_display }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Amount</span>
              <span class="amount">₱{{ cert_request.payment_amount }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Payment Mode</span>
              <span>{{ cert_request.get_payment_mode_display }}</span>
            </div>
          </div>
        </div>

        <div class="panel">
          <h2>How to Pay On-site</h2>
          <div class="steps">
            <ol>
              <li>Go to Barangay Hall of Labangon Cashier within office hours.</li>
              <li>Present your Request ID: <span class="request-id">{{ cert_request.request_id }}</span>.</li>
              <li>Pay the amount of <strong>₱{{ cert_request.payment_amount }}</strong>.</li>
              <li>Keep the official receipt. Your payment will be verified by our staff.</li>
            </ol>
          </div>
          <div class="alert">
            Note: After you click “I will pay on-site”, we’ll mark this request as pending verification until your payment is confirmed at the cashier.
          </div>

          <form method="post" class="actions">
            {% csrf_token %}
            <button type="submit" class="btn-primary">I will pay on-site</button>
            <a href="{% url 'accounts:certificate_requests' %}" class="btn-secondary">Back to Requests</a>
          </form>

          <div class="print-card">
            <div>
              <div class="print-title">Payment Slip</div>
              <div class="print-sub">Print or screenshot this page to bring to the cashier.</div>
            </div>
            <button class="btn-secondary" onclick="window.print()">Print</button>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="{% static 'js/dashboard.js' %}"></script>
</body>
</html>